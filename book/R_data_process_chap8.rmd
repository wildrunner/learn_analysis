---
title: "8장. 선형회귀"
output:
  html_document:
    toc: true
    toc_depth: 4
    theme: united
    highlight: tango  
    mathjax: "http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
---

## 1. 선형 회귀의 기본 가정

***
선형 회귀는 종속 변수 ${Y}_{i}$와 독립변수 ${X}_{i1}$, ${X}_{i2}$, ..., ${X}_{ip}$를 다음과 같은 선형식으로 표현한다. ${\beta}_{p}$는 회귀 모델의 계수이며, ${\varepsilon}_{i}$는 오차(error)다.

$$
{Y }_{ i }={ \beta  }_{ 0 } + { \beta  }_{ 1 }{ X }_{ i1 } + ... + { \beta  }_{ p }{ X }_{ ip } + { \varepsilon  }_{ i }
\quad\quad\quad(식 8.1)
$$ 

이러한 선형모델이 유용한 경우는 브레이크를 밟기 전의 주행속도와 제동거리간의 관계, 아버지와 아들의 키의 관계 등이 있다.
위의 식에서 선형 회귀는 일반적으로 다음과 같은 내용을 가정한다.

* 종속 변수와 독립 변수들간의 관계는 식8-1과 같은 선형성이 성립한다.
* 독립 변수는 정확히 측정된 값으로 고정된 값이다.
* 오차는 평균이 0, 분산은 ${\sigma}^{2}$ 인 정규분포를 따르며 모든 i에 대해 평균과 분산이 일정하다. 서로 다른 i, j에 대해 ${\varepsilon}_{i}$, ${\varepsilon}_{j}$는 독립이다.
* 독립 변수간에는 다중 공선성이 적어야 한다. 다중 공선성은 회귀 모델에서 변수 간의 상관관계가 커서 한 변수를 다른 변수들의 선형 조합으로 손쉽계 예측하는 경우를 뜻한다.


## 2. 단순 선형 회귀
***
단순 선형 회귀는 종속 변수를 하나의 독립 변수로 설명한다. 두 개 이상의 독립 변수로 설명하는 경우는 중선형 회귀라 한다. 단순 선형 회귀 모델은 다음과 같이 표현된다. 
$$
{Y}_{i}={ \beta  }_{ 0 } + { \beta  }_{ 1 }{ X }_{ i } + { \varepsilon  }_{ i }
$$ 

```{r}
(m <- lm(dist ~ speed, cars))
```

$$
dist = -17.759 + 3.932 x speed + {\varepsilon}
$$

### 선형 회귀 결과 추출
#### 회귀 계수: coef(model)
```{r}
coef(m)
```

#### 적합된 값: fitted(model)
모델에 의해 예측된 종속변수의 값을 보여주며, 모델이 데이터에 적합된 결과이므로 적합된 값이라고 부른다.
```{r}
fitted(m)[1:4]
```


#### 잔차: residuals(model)
식8-1에서 오차는 이론적인 값을 부르는 명칭, 모델로부터 구한 예측값과 살제 값 사이의 차이는 잔차라고 부른다.
```{r}
residuals(m)[1:4]
```

```{r}
fitted(m)[1:4] + residuals(m)[1:4]
cars$dist[1:4]
```

#### 회귀 계수의 신뢰 구간: confint(model)
단순 선형 회귀에서 절편과 speed의 기울기는 정규 분포를 따른다. 따라서 t 분포를 사용한 신뢰구간을 confint(model)을 사용해 구할 수 있다.
```{r}
confint(m)
```

#### 잔차 제곱 합
잔차 제곱 합 $\sum { { \varepsilon  }_{ i }^{ 2 } }$은 다음과 같이 구한다.
```{r}
deviance(m)
```
선형 회귀의 회귀 계수는 최소 제곱법으로 추정하며, 이 경우 오차의 제곱합이 최소가 되도록 회귀 계수를 정한다. 이 때문에 잔체 제곱 합은 데이터와 추정된 모델간의 불일치 정도를 표현하는 것으로 볼 수 있다.

#### 예측과 신뢰 구간
lm()을 통해 모델을 만들고, predict()로 새로운 데이터에 대한 예측을 한다. 내부적으로는 predict.lm()이 호출된다.
```{r}
(m <- lm(dist ~ speed, data=cars))
predict(m, newdata=data.frame(speed=3))
```

회귀 계수의 신뢰구간을 고려하기 위해 type="confidence"를 지정하면 제동 거리의 평균 신뢰 구간을 구할 수 있다. 이 경우 오차의 평균은 0으로 가정한다. 
```{r}
predict(m, newdata=data.frame(speed=c(3)), interval="confidence")
```
특정 속도를 가진 차량 한 대가 주어졌을때 해당 차량에 대해 제동거리를 생각한다면 오차를 무시할 수 없다. 이 경우 type="prediction"을 사용해 예측 구간을 구한다.
```{r}
predict(m, newdata=data.frame(speed=c(3)), interval="prediction")
```

#### 모델 평가 


## 3. 중선형 회귀
***

## 4. 이상치
***

## 5. 변수 선택
***